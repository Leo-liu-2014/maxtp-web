/*! maxtp 2015-10-08 */
define(function(a,b,c){function d(a){var b="string"==typeof a.box?p(a.box):a.box;b.on("click",function(a){a.stopPropagation(),p(this).show()}),p(document.body).on("click",function(){b.hide()})}function e(a){for(var b={ShutDownFn:a.DownFn||".close",RemoveBox:a.del||!1,write:a.write||""},c=2;p("#MASK"+c).length>0;)c++;f(a,1),p(document.body).append("<div mask='mask' id='MASK"+c+"'></div>"+b.write),h(a,c),0!=a.mask&&i(p("#MASK"+c),c).fadeIn(300),l(a,c).fadeIn(300),j(p("#MASK"+c),c,a),k(p(a.box),p("#MASK"+c),b.ShutDownFn,b.RemoveBox,a.lastfn,a.This),m(a,c,b.RemoveBox),a.documentEvent&&d(a)}function f(a,b){a.write&&1==b&&p(a.box).length>0&&p(a.box).remove()}function g(a){var b={};for(var c in a){if(b[a[c]])return!0;b[a[c]]=!0}return!1}function h(a,b){function c(b,c,d){return a[b]&&null!=a[b]&&"undefined"!=a[b]?a[c]='<input type="button" class="'+d+'" value="'+a[b]+'">':void 0}var d={title:a.title||"温馨提示",okval:a.okval||"确认",noval:a.noval||"取消",noval:a.btn,bgcolor:"bgyellow"==a.bgcolor?"bg_box_orange":a.bgcolor||"bg_box_green",conCon:"",btncon:""};if(a.content){for(var e="del"==a.title?"":"<h3>"+d.title+"<span class='close'></span></h3>",f="del"==a.title?"titledel":"",g=0;g<a.content.split("|").length;g++)d.conCon+=a.liclass?'<li class="'+a.liclass[g]+'">'+a.content.split("|")[g]+"</li>":a.allclass?'<li class="'+a.allclass+'">'+a.content.split("|")[g]+"</li>":"<li>"+a.content.split("|")[g]+"</li>";a.btn?d.btncon="<p class='btnLength'><input type='button' value='确定' class='bg1 leftBtn okBtn'><input type='button' value='取消' class='bg2 rightBtn noBtn'></p>":(a.okCon=a.noCon="",c("okval","okCon","bg1 okBtn"),c("noval","noCon","bg2 noBtn"),(a.okval||a.noval)&&(d.btncon='<p class="btnLength">'+a.okCon+a.noCon+"</p>")),p(document.body).append("<div id='DialogBox"+b+"' class='pop-box "+f+" "+d.bgcolor+"'>"+e+"<div class='pop_cont'><ul>"+d.conCon+"</ul>"+d.btncon+"</div></div>"),a.box="#DialogBox"+b}}function i(a){var b=.6,c=Math.max(p(document).width(),p(document.body).width()),d=Math.max(p(document).height(),p(document.body).height());return a.css({position:"absolute",width:c+"px",height:d+"px",background:"#333",left:0,top:0,opacity:0,zIndex:100}).animate({opacity:b},500)}function j(a,b,c){var d={WindowScrollSize:0==c.scrollSize?"false":"true"};"true"==d.WindowScrollSize&&p(window).scroll(function(){"block"==p(c.box).css("display")&&l(c,b)}),p(window).resize(function(){"block"==a.css("display")&&"del"!=c.title&&0!=c.mask&&i(a,b),"block"==p(c.box).css("display")&&l(c,b)})}function k(a,b,c,d,e,f){a.find(c).off("click",null),a.find(c).on("click",function(){"function"!=typeof e&&null!=e?q.lert("alway",{del:!0,content:e.content,okval:e.okval,noval:e.noval,down:".close",ok:function(){d?a.remove():a.hide(),b.remove(),e.fn&&e.fn(),a.find(".okBtn").off("click",null),a.find(".noBtn").off("click",null)}}):(d?a.remove():a.hide(),b.remove(),e&&e(),a.find(".okBtn").off("click",null),a.find(".noBtn").off("click",null),f&&p(f).addClass("circle1"))})}function l(a){var b=null;if(p(a.box).css("position","absolute"),a.follow){var c=a.follow[2]?a.follow[2]:a.This;b=p(a.box).css({width:"auto",zIndex:120,top:p(c).offset().top+a.follow[1],left:p(c).offset().left+a.follow[0]})}else b=p(a.box).css({zIndex:120,top:(p(window).height()-p(a.box).outerHeight())/2+p(document).scrollTop()+"px",left:(p(window).width()-p(a.box).outerWidth())/2+p(document).scrollLeft()+"px"});return b}function m(a,b,c){function d(b,c,d){p(b+" "+c).each(function(){var b=p(this).parent().find(".textError");p(this).on("focus",function(){a.onfocus||1!=d||(p(this).parent().addClass("ongreen"),b.removeClass("yellow").addClass("green").html(b.attr("data-val")).fadeIn(1)),endcount(p(this)),inputCount(this)}),p(this).on("blur",function(){var b=this;setTimeout(function(){nomust(p(b),null,a.inputText)},1)})})}var e=null,f=p(a.This).index(".addfs");d(a.box,"input[type=text]",1),d(a.box,"input[type=password]",1),d(a.box,"textarea",0),p(a.box).find(".serachBtn").off("click",null),p(a.box).find(".serachBtn").on("click",function(){var b=q.must(a.box+" .mustVal"),c=q.least(a.box+" .mustVal",a.checkImg),d=(q.Radioeffect(a.box+" .mustVal"),q.seleffect(a.box+" select.mustVal",a.selText)),e=q.password(n(a.pwd1),n(a.pwd2)),f=q.inputnomust(a.box,a.inputText,"input[type=password]"),g=q.inputnomust(a.box,a.inputText,"textarea"),h=q.inputnomust(a.box,a.inputText,"input[type=text]");h&&g&&f&&b&&c[0]&&d&&e?a.searchfn&&a.searchfn(p(a.box),p(a.This)):(q.least(a.box+" .mustVal",a.checkImg,!0),q.Radioeffect(a.box+" .mustVal",!0),q.seleffect(a.box+" .mustVal",a.selText,!0),q.password(n(a.pwd1),n(a.pwd2),!0)),setTimeout(function(){p(this).blur()},1)}),p(a.box).find(".sureBtn").off("click",null),p(a.box).find(".sureBtn").on("click",function(){var d=function(){c?p(a.box).remove():p(a.box).hide(),p("#MASK"+b).remove()},e=p(a.box).find(".text"),g=e.eq(1).find("span").html(),h=e.eq(4).find("span").html(),i=p(".img1").attr("src"),j=p(".img2").attr("src");$olChild=p(".obj1>ol").eq(f),$imgClass=$olChild.find(".img"),$img=$imgClass.find("img"),$nickname=$imgClass.find(".txt"),$medal=$imgClass.find(".txt1"),$fans=$imgClass.find(".txt2"),$icon=$olChild.find(".icon"),$iconimg=$icon.find("img"),0!=p("ul#userInfo").children().length&&""!=g&&""!=h&&"undefined"!=i&&"undefined"!=j&&($img.attr("src",i),$iconimg.attr("src",j),$nickname.html(g),$medal.html("品牌勋章："+h),$fans.html("粉丝："+h)),a.notfn&&a.notfn(p(a.box),p(a.This),d),a.ok&&a.ok(p(a.box),p(a.This),d),d()}),p(a.box).find(".okBtn").off("click",null),p(a.box).find(".okBtn").on("click",function(){var d=q.must(a.box+" .mustVal"),e=q.least(a.box+" .mustVal",a.checkImg),f=(q.Radioeffect(a.box+" .mustVal"),q.seleffect(a.box+" select.mustVal",a.selText)),g=q.password(n(a.pwd1),n(a.pwd2)),h=q.inputnomust(a.box,a.inputText,"input[type=password]"),i=q.inputnomust(a.box,a.inputText,"textarea"),j=q.inputnomust(a.box,a.inputText,"input[type=text]");if(j&&i&&h&&d&&e[0]&&f&&g)if(a.notoff){var k=function(){c?p(a.box).remove():p(a.box).hide(),p("#MASK"+b).remove()};setTimeout(function(){a.notfn&&a.notfn(p(a.box),p(a.This),k),a.ok&&a.ok(p(a.box),p(a.This),k)},1)}else setTimeout(function(){a.ok&&a.ok(p(a.box),p(a.This),a.obj),p("#MASK"+b).remove(),c?p(a.box).remove():p(a.box).hide()},1);else q.least(a.box+" .mustVal",a.checkImg,!0),q.Radioeffect(a.box+" .mustVal",!0),q.seleffect(a.box+" .mustVal",a.selText,!0),q.password(n(a.pwd1),n(a.pwd2),!0);setTimeout(function(){p(this).blur()},1)}),p(a.box).find(".noBtn").on("click",function(){setTimeout(function(){c?p(a.box).remove():p(a.box).hide()},1),p("#MASK"+b).remove(),a.no&&a.no(p(a.box),p(a.This),a.obj),p(this).off("click",null),p(a.box).find(".okBtn").off("click",null)}),a.timing&&(e=setTimeout(function(){c?p(a.box).remove():p(a.box).hide(),p("#MASK"+b).remove()},a.timing)),p(document).keypress(function(b){13==b.which&&p(a.box).find(".okBtn").click()})}function n(a){return"object"==typeof a?a:p(a)}var o,p=a("jq"),q={must:function(a,b){var c=!0;return p("img.must",a).each(function(){if(""==p(this).attr("src")){var d=p(this).parents(a).find(".textError");b&&(d.fadeIn(300),d.html(d.attr("data-val"))),c=!1}}),c},least:function(a,b,c){var d=!0,e=!0;return p(a).each(function(){d=blurImg(this,b,!0,c,this),d||(e=d)}),[e]},inputnomust:function(a,b,c,d){var e=p(a+" "+c).length;return p(a+" "+c).each(function(){e=nomust(p(this),e,b),d&&p(this).on("keydown",function(){var a=p(this);setTimeout(function(){nomust(a,e,b)},1)})}),0==e?!0:!1},Radioeffect:function(a,b){var c=!0;return p(a).each(function(){var a=this;p("input[type=radio]",a).length>0&&(0==p("input[type=radio]:checked",a).length?(c=!1,b&&p(".textError",this).show().html("<i class='"+o+"'></i>"+p(".textError",this).attr("data-val"))):(c=!0,b&&p(".textError",this).hide())),p("input[type=radio]",a).on("click",function(){c=!0,b&&p(".textError",a).hide()})}),c},seleffect:function(a,b){function c(a){p(a).each(function(){if("SELECT"==p(this).get(0).tagName){var a=blurSel(p(this),b);d&&(d=a)}})}var d=!0;return p(a).change(function(){c(p(this))}),c(p(a)),d},password:function(a,b,c){function d(c,d){q.password(a,b)?""!=b.val()&&(1==d?f.show():(b.parent().removeClass("oncaps"),f.hide())):""!=b.val()&&(1==d?(c.parent().removeClass("ongreen").addClass("oncaps"),f.show()):(b.parent().removeClass("ongreen").addClass("oncaps"),f.removeClass("green").addClass("yellow").html(h).show()))}var e=[a.val(),b.val()],f=b.parent().find(".textError"),h="<i class='"+o+"'></i>两次输入密码不一致";return c&&(""==b.val()||q.password(a,b)||setTimeout(function(){f.removeClass("green").addClass("yellow").html(h).show()},1),b.on("blur",function(){setTimeout(function(){d(p(this))},1)}),b.on("focus",function(){setTimeout(function(){d(p(this),1)},1)}),a.on("blur",function(){setTimeout(function(){d(p(this))},1)})),g(e)}};c.exports={lert:function(a,b){switch(b.obj="string"==typeof b.obj?p(b.obj):b.obj,a){case"click":b.obj.off("click",null),b.obj.on("click",function(a){a.stopPropagation();var c=this;e({box:b.box,scrollSize:b.scrollSize,DownFn:b.DownFn,del:b.del,onfocus:b.onfocus,notoff:b.notoff,notfn:b.notfn,title:b.title,bgcolor:b.bgcolor,content:b.content,write:b.write,documentEvent:b.documentEvent,liclass:b["class"],allclass:b.allclass,follow:b.follow,okval:b.okval,noval:b.noval,ok:b.ok,no:b.no,sear:b.sear,searchfn:b.searchfn,defaultfn:b.defaultfn,lastfn:b.lastfn,timing:b.timing,mask:b.mask,inputText:b.inputText,checkImg:b.checkImg,btn:b.btn,obj:b.obj,This:c}),b.startfn&&b.startfn(b.box,p(c))});break;case"alway":e({box:b.box,scrollSize:b.scrollSize,DownFn:b.DownFn,del:b.del,onfocus:b.onfocus,notoff:b.notoff,notfn:b.notfn,title:b.title,bgcolor:b.bgcolor,write:b.write,documentEvent:b.documentEvent,content:b.content,liclass:b["class"],allclass:b.allclass,follow:b.follow,okval:b.okval,noval:b.noval,ok:b.ok,startfn:b.startfn,no:b.no,lastfn:b.lastfn,timing:b.timing,mask:b.mask,inputText:b.inputText,checkImg:b.checkImg,btn:b.btn,defaultfn:b.defaultfn}),b.defaultfn&&b.defaultfn(b.box);break;case"dblclick":b.obj.off("dblclick",null),b.obj.on("dblclick",function(a){a.stopPropagation();var c=this;e({box:b.box,scrollSize:b.scrollSize,DownFn:b.DownFn,del:b.del,onfocus:b.onfocus,notoff:b.notoff,notfn:b.notfn,title:b.title,bgcolor:b.bgcolor,content:b.content,write:b.write,documentEvent:b.documentEvent,liclass:b["class"],allclass:b.allclass,follow:b.follow,okval:b.okval,noval:b.noval,ok:b.ok,no:b.no,lastfn:b.lastfn,timing:b.timing,mask:b.mask,inputText:b.inputText,btn:b.btn,obj:b.obj,This:c}),b.startfn&&b.startfn(b.box,this)});break;case"show":b.obj.off("click",null),b.obj.on("click",function(){var a=this;e({box:b.box,scrollSize:b.scrollSize,DownFn:b.DownFn,del:b.del,onfocus:b.onfocus,title:b.title,bgcolor:b.bgcolor,content:b.content,liclass:b["class"],allclass:b.allclass,follow:b.follow,okval:b.okval,noval:b.noval,no:b.no,ok:b.ok,lastfn:b.lastfn,timing:b.timing,mask:b.mask,inputText:b.inputText,btn:b.btn,obj:b.obj,This:a}),b.startfn&&b.startfn()});break;case"alshow":e({box:b.box,scrollSize:b.scrollSize,DownFn:b.DownFn,del:b.del,onfocus:b.onfocus,title:b.title,bgcolor:b.bgcolor,content:b.content,liclass:b["class"],allclass:b.allclass,follow:b.follow,okval:b.okval,noval:b.noval,ok:b.ok,no:b.no,lastfn:b.lastfn,timing:b.timing,mask:b.mask,inputText:b.inputText,btn:b.btn})}}}});